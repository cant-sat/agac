import{r as L}from"./index-D7pVF8RR.js";import{ae as v0,af as R0}from"./index-ba8afaa4.esm-Dji6U1T2.js";var S0=Object.defineProperty,q0=(C,N,t)=>N in C?S0(C,N,{enumerable:!0,configurable:!0,writable:!0,value:t}):C[N]=t,S=(C,N,t)=>(q0(C,typeof N!="symbol"?N+"":N,t),t);class w0{constructor(N=Math){S(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),S(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),S(this,"p",[]),S(this,"perm",[]),S(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),S(this,"dot",(t,p,d)=>t[0]*p+t[1]*d),S(this,"dot3",(t,p,d,M)=>t[0]*p+t[1]*d+t[2]*M),S(this,"dot4",(t,p,d,M,j)=>t[0]*p+t[1]*d+t[2]*M+t[3]*j),S(this,"noise",(t,p)=>{let d,M,j;const l=.5*(Math.sqrt(3)-1),e=(t+p)*l,G=Math.floor(t+e),s=Math.floor(p+e),u=(3-Math.sqrt(3))/6,h=(G+s)*u,z=G-h,g=s-h,k=t-z,v=p-g;let _=0,o=1;k>v&&(_=1,o=0);const m=k-_+u,n=v-o+u,c=k-1+2*u,x=v-1+2*u,y=G&255,F=s&255,b=this.perm[y+this.perm[F]]%12,i=this.perm[y+_+this.perm[F+o]]%12,r=this.perm[y+1+this.perm[F+1]]%12;let a=.5-k*k-v*v;a<0?d=0:(a*=a,d=a*a*this.dot(this.grad3[b],k,v));let f=.5-m*m-n*n;f<0?M=0:(f*=f,M=f*f*this.dot(this.grad3[i],m,n));let R=.5-c*c-x*x;return R<0?j=0:(R*=R,j=R*R*this.dot(this.grad3[r],c,x)),70*(d+M+j)}),S(this,"noise3d",(t,p,d)=>{let M,j,l,e;const s=(t+p+d)*.3333333333333333,u=Math.floor(t+s),h=Math.floor(p+s),z=Math.floor(d+s),g=1/6,k=(u+h+z)*g,v=u-k,_=h-k,o=z-k,m=t-v,n=p-_,c=d-o;let x,y,F,b,i,r;m>=n?n>=c?(x=1,y=0,F=0,b=1,i=1,r=0):m>=c?(x=1,y=0,F=0,b=1,i=0,r=1):(x=0,y=0,F=1,b=1,i=0,r=1):n<c?(x=0,y=0,F=1,b=0,i=1,r=1):m<c?(x=0,y=1,F=0,b=0,i=1,r=1):(x=0,y=1,F=0,b=1,i=1,r=0);const a=m-x+g,f=n-y+g,R=c-F+g,Z=m-b+2*g,H=n-i+2*g,O=c-r+2*g,W=m-1+3*g,A=n-1+3*g,w=c-1+3*g,P=u&255,X=h&255,Y=z&255,B=this.perm[P+this.perm[X+this.perm[Y]]]%12,D=this.perm[P+x+this.perm[X+y+this.perm[Y+F]]]%12,J=this.perm[P+b+this.perm[X+i+this.perm[Y+r]]]%12,K=this.perm[P+1+this.perm[X+1+this.perm[Y+1]]]%12;let q=.6-m*m-n*n-c*c;q<0?M=0:(q*=q,M=q*q*this.dot3(this.grad3[B],m,n,c));let E=.6-a*a-f*f-R*R;E<0?j=0:(E*=E,j=E*E*this.dot3(this.grad3[D],a,f,R));let I=.6-Z*Z-H*H-O*O;I<0?l=0:(I*=I,l=I*I*this.dot3(this.grad3[J],Z,H,O));let T=.6-W*W-A*A-w*w;return T<0?e=0:(T*=T,e=T*T*this.dot3(this.grad3[K],W,A,w)),32*(M+j+l+e)}),S(this,"noise4d",(t,p,d,M)=>{const j=this.grad4,l=this.simplex,e=this.perm,G=(Math.sqrt(5)-1)/4,s=(5-Math.sqrt(5))/20;let u,h,z,g,k;const v=(t+p+d+M)*G,_=Math.floor(t+v),o=Math.floor(p+v),m=Math.floor(d+v),n=Math.floor(M+v),c=(_+o+m+n)*s,x=_-c,y=o-c,F=m-c,b=n-c,i=t-x,r=p-y,a=d-F,f=M-b,R=i>r?32:0,Z=i>a?16:0,H=r>a?8:0,O=i>f?4:0,W=r>f?2:0,A=a>f?1:0,w=R+Z+H+O+W+A;let P,X,Y,B,D,J,K,q,E,I,T,c0;P=l[w][0]>=3?1:0,X=l[w][1]>=3?1:0,Y=l[w][2]>=3?1:0,B=l[w][3]>=3?1:0,D=l[w][0]>=2?1:0,J=l[w][1]>=2?1:0,K=l[w][2]>=2?1:0,q=l[w][3]>=2?1:0,E=l[w][0]>=1?1:0,I=l[w][1]>=1?1:0,T=l[w][2]>=1?1:0,c0=l[w][3]>=1?1:0;const i0=i-P+s,r0=r-X+s,l0=a-Y+s,h0=f-B+s,a0=i-D+2*s,f0=r-J+2*s,p0=a-K+2*s,d0=f-q+2*s,m0=i-E+3*s,u0=r-I+3*s,g0=a-T+3*s,M0=f-c0+3*s,j0=i-1+4*s,k0=r-1+4*s,x0=a-1+4*s,y0=f-1+4*s,Q=_&255,U=o&255,V=m&255,$=n&255,z0=e[Q+e[U+e[V+e[$]]]]%32,F0=e[Q+P+e[U+X+e[V+Y+e[$+B]]]]%32,_0=e[Q+D+e[U+J+e[V+K+e[$+q]]]]%32,b0=e[Q+E+e[U+I+e[V+T+e[$+c0]]]]%32,N0=e[Q+1+e[U+1+e[V+1+e[$+1]]]]%32;let t0=.6-i*i-r*r-a*a-f*f;t0<0?u=0:(t0*=t0,u=t0*t0*this.dot4(j[z0],i,r,a,f));let s0=.6-i0*i0-r0*r0-l0*l0-h0*h0;s0<0?h=0:(s0*=s0,h=s0*s0*this.dot4(j[F0],i0,r0,l0,h0));let e0=.6-a0*a0-f0*f0-p0*p0-d0*d0;e0<0?z=0:(e0*=e0,z=e0*e0*this.dot4(j[_0],a0,f0,p0,d0));let o0=.6-m0*m0-u0*u0-g0*g0-M0*M0;o0<0?g=0:(o0*=o0,g=o0*o0*this.dot4(j[b0],m0,u0,g0,M0));let n0=.6-j0*j0-k0*k0-x0*x0-y0*y0;return n0<0?k=0:(n0*=n0,k=n0*n0*this.dot4(j[N0],j0,k0,x0,y0)),27*(u+h+z+g+k)});for(let t=0;t<256;t++)this.p[t]=Math.floor(N.random()*256);for(let t=0;t<512;t++)this.perm[t]=this.p[t&255]}}const T0=L.forwardRef(({intensity:C=1,decay:N,decayRate:t=.65,maxYaw:p=.1,maxPitch:d=.1,maxRoll:M=.1,yawFrequency:j=.1,pitchFrequency:l=.1,rollFrequency:e=.1},G)=>{const s=v0(o=>o.camera),u=v0(o=>o.controls),h=L.useRef(C),z=L.useRef(s.rotation.clone()),[g]=L.useState(()=>new w0),[k]=L.useState(()=>new w0),[v]=L.useState(()=>new w0),_=()=>{(h.current<0||h.current>1)&&(h.current=h.current<0?0:1)};return L.useImperativeHandle(G,()=>({getIntensity:()=>h.current,setIntensity:o=>{h.current=o,_()}}),[]),L.useEffect(()=>{if(u){const o=()=>void(z.current=s.rotation.clone());return u.addEventListener("change",o),o(),()=>void u.removeEventListener("change",o)}},[s,u]),R0((o,m)=>{const n=Math.pow(h.current,2),c=p*n*g.noise(o.clock.elapsedTime*j,1),x=d*n*k.noise(o.clock.elapsedTime*l,1),y=M*n*v.noise(o.clock.elapsedTime*e,1);s.rotation.set(z.current.x+x,z.current.y+c,z.current.z+y),N&&h.current>0&&(h.current-=t*m,_())}),null});export{T0 as C};
